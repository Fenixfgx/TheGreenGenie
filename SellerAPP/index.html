<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Sellers</title>
  <link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SELLER</title>
    <link rel="stylesheet" href="styles.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<div class="containeringr">
<h2>LOGIN SELLER</h2><br>
<img id="token-image" src="https://www.thegreengenie.com.co/images/logos21.png"><img id="token-back" src="https://www.thegreengenie.com.co/images/circle.png"><br><br>
<form id="loginForm"><br>
<div style="display: flex;"><input class="inputoken" type="text" id="token" placeholder="Token" required><button class="ingreso" type="submit"> > </button></div>
        </form>
    </div>
  
<section id="primero" style="display: none;">
  <body>
    <main>
      <nav class="main-menu">
        <img class="logo" src="https://www.thegreengenie.com.co/images/LOGOBLANCO.png" alt="" />
        <ul>
          
<li class="nav-item active rel" >
  <b></b>
  <b></b>
  <a href="#" onclick="mostrarDuo()">
    <svg width="34px" height="34px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svg-icon">
      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
      <g id="SVGRepo_iconCarrier">
        <path d="M12 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20H12M12 4H18C19.1046 4 20 4.89543 20 6V18C20 19.1046 19.1046 20 18 20H12M12 4V20" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
      </g>
    </svg>
    <span class="tooltip">DUO HOME</span>
  </a>
</li>
          
  <li class="nav-item">
  <b></b>
  <b></b>
  <a href="#" onclick="ocultarDiv()">
    <svg width="35px" height="35px" viewBox="0 0 24.00 24.00" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0)" class="svg-icon">
      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.288"></g>
      <g id="SVGRepo_iconCarrier">
        <path d="M13 3H8.2C7.0799 3 6.51984 3 6.09202 3.21799C5.71569 3.40973 5.40973 3.71569 5.21799 4.09202C5 4.51984 5 5.0799 5 6.2V17.8C5 18.9201 5 19.4802 5.21799 19.908C5.40973 20.2843 5.71569 20.5903 6.09202 20.782C6.51984 21 7.0799 21 8.2 21H10M13 3L19 9M13 3V7.4C13 7.96005 13 8.24008 13.109 8.45399C13.2049 8.64215 13.3578 8.79513 13.546 8.89101C13.7599 9 14.0399 9 14.6 9H19M19 9V10M9 17H11.5M9 13H14M9 9H10M14 21L16.025 20.595C16.2015 20.5597 16.2898 20.542 16.3721 20.5097C16.4452 20.4811 16.5147 20.4439 16.579 20.399C16.6516 20.3484 16.7152 20.2848 16.8426 20.1574L21 16C21.5523 15.4477 21.5523 14.5523 21 14C20.4477 13.4477 19.5523 13.4477 19 14L14.8426 18.1574C14.7152 18.2848 14.6516 18.3484 14.601 18.421C14.5561 18.4853 14.5189 18.5548 14.4903 18.6279C14.458 18.7102 14.4403 18.7985 14.405 18.975L14 21Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
      </g>
    </svg>
    <span class="tooltip">Registro de Ventas</span>
  </a>
</li>

<li class="nav-item">
  <b></b>
  <b></b>
  <a href="#" onclick="listaDiv()">
    <svg width="32px" height="32px" viewBox="0 0 24 24" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" fill="#000000" class="svg-icon">
      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
      <g id="SVGRepo_iconCarrier">
        <defs>
          <style>.cls-1{fill:none;stroke:#020202;stroke-miterlimit:10;stroke-width:1.91px;}</style>
        </defs>
        <line class="cls-1" x1="17.73" y1="11.05" x2="10.09" y2="11.05"></line>
        <line class="cls-1" x1="17.73" y1="14.86" x2="10.09" y2="14.86"></line>
        <line class="cls-1" x1="17.73" y1="18.68" x2="10.09" y2="18.68"></line>
        <polygon class="cls-1" points="20.59 6.27 20.59 22.5 3.41 22.5 3.41 1.5 15.82 1.5 20.59 6.27"></polygon>
        <polygon class="cls-1" points="20.59 6.27 20.59 7.23 14.86 7.23 14.86 1.5 15.82 1.5 20.59 6.27"></polygon>
        <line class="cls-1" x1="6.27" y1="11.05" x2="8.18" y2="11.05"></line>
        <line class="cls-1" x1="6.27" y1="14.86" x2="8.18" y2="14.86"></line>
        <line class="cls-1" x1="6.27" y1="18.68" x2="8.18" y2="18.68"></line>
      </g>
    </svg>
    <span class="tooltip">Ordenes</span>
  </a>
</li>          

<li class="nav-item" style="display:none;">
  <b></b>
  <b></b>
  <a href="#" onclick="listaOrd()">
    <svg width="32px" height="32px" viewBox="0 0 24 24" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" fill="#000000" class="svg-icon">
      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
      <g id="SVGRepo_iconCarrier">
        <defs>
          <style>.cls-1{fill:none;stroke:#020202;stroke-miterlimit:10;stroke-width:1.91px;}</style>
        </defs>
        <line class="cls-1" x1="17.73" y1="11.05" x2="10.09" y2="11.05"></line>
        <line class="cls-1" x1="17.73" y1="14.86" x2="10.09" y2="14.86"></line>
        <line class="cls-1" x1="17.73" y1="18.68" x2="10.09" y2="18.68"></line>
        <polygon class="cls-1" points="20.59 6.27 20.59 22.5 3.41 22.5 3.41 1.5 15.82 1.5 20.59 6.27"></polygon>
        <polygon class="cls-1" points="20.59 6.27 20.59 7.23 14.86 7.23 14.86 1.5 15.82 1.5 20.59 6.27"></polygon>
        <line class="cls-1" x1="6.27" y1="11.05" x2="8.18" y2="11.05"></line>
        <line class="cls-1" x1="6.27" y1="14.86" x2="8.18" y2="14.86"></line>
        <line class="cls-1" x1="6.27" y1="18.68" x2="8.18" y2="18.68"></line>
      </g>
    </svg>
    <span class="tooltip">Lista de Ventas</span>
  </a>
</li>

<li class="nav-item">
  <b></b>
  <b></b>
  <a href="#" onclick="addClient()">
    <svg width="34px" height="34px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svg-icon">
      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
      <g id="SVGRepo_iconCarrier">
        <g id="Iconly/Curved/Plus">
          <g id="Plus">
            <path id="Stroke 1" d="M12.0368 8.46265V15.6111" stroke="#130F26" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
            <path id="Stroke 2" d="M15.6148 12.0368H8.45898" stroke="#130F26" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
            <path id="Stroke 3" fill-rule="evenodd" clip-rule="evenodd" d="M2.30005 12.0369C2.30005 4.73479 4.73479 2.30005 12.0369 2.30005C19.339 2.30005 21.7737 4.73479 21.7737 12.0369C21.7737 19.339 19.339 21.7737 12.0369 21.7737C4.73479 21.7737 2.30005 19.339 2.30005 12.0369Z" stroke="#130F26" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          </g>
        </g>
      </g>
    </svg>
<span class="tooltip">Agregar Cliente</span>
  </a>
</li>


          <li class="nav-item">
  <b></b>
  <b></b>
  <a href="#" onclick="adminClients()">
    <svg width="34px" height="34px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svg-icon">
      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
      <g id="SVGRepo_iconCarrier">
        <path d="M19 15C21.2091 15 23 16.7909 23 19V21H21M16 10.874C17.7252 10.4299 19 8.86384 19 7C19 5.13617 17.7252 3.57007 16 3.12602M5 15C2.79086 15 1 16.7909 1 19V21H17V19C17 16.7909 15.2091 15 13 15H9M9 3C6.79086 3 5 4.79086 5 7C5 9.20914 6.79086 11 9 11C11.2091 11 13 9.20914 13 7C13 6.27143 12.8052 5.58835 12.4649 5" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
      </g>
    </svg>
    <span class="tooltip">Administrar Clientes</span>
  </a>
</li>

<li class="nav-item">
  <b></b>
  <b></b>
  <a href="#" onclick="preciosxClients()" style="font-size: 35px;">
  $
    <span class="tooltip">Precios x Cliente</span>
  </a>
</li>
          
<li class="nav-item" style="display:none;">
  <b></b>
  <b></b>
  <a href="#" onclick="programord()" style="font-size: 35px;">
  <svg fill="white" version="1.1" class="svg-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="34px" height="34px" viewBox="0 0 30.998 30.998" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M18.73,16.686l-1.713-0.205c-0.176-0.654-0.433-1.271-0.763-1.844l1.063-1.354c0.164-0.209,0.145-0.531-0.043-0.718 l-1.766-1.767c-0.187-0.187-0.509-0.206-0.717-0.044l-1.356,1.067c-0.571-0.33-1.188-0.587-1.841-0.761L11.39,9.345 c-0.031-0.262-0.273-0.477-0.537-0.477H8.354c-0.264,0-0.506,0.215-0.537,0.477l-0.206,1.714 c-0.653,0.174-1.271,0.432-1.842,0.762l-1.357-1.065c-0.207-0.163-0.53-0.145-0.716,0.042l-1.767,1.769 c-0.187,0.187-0.206,0.509-0.043,0.717l1.065,1.354c-0.331,0.572-0.586,1.19-0.761,1.844l-1.713,0.205 C0.215,16.718,0,16.959,0,17.225v2.498c0,0.265,0.215,0.506,0.477,0.536l1.714,0.207c0.175,0.651,0.431,1.269,0.761,1.841 l-1.064,1.354c-0.163,0.21-0.144,0.532,0.043,0.719l1.765,1.767c0.186,0.188,0.509,0.207,0.716,0.045l1.357-1.068 c0.571,0.33,1.189,0.588,1.842,0.762L7.817,27.6c0.031,0.262,0.273,0.477,0.537,0.477h2.499c0.264,0,0.506-0.215,0.537-0.477 l0.206-1.715c0.653-0.174,1.271-0.432,1.843-0.762l1.356,1.064c0.208,0.162,0.53,0.145,0.716-0.041l1.767-1.77 c0.187-0.188,0.207-0.51,0.043-0.717l-1.065-1.354c0.331-0.572,0.586-1.19,0.761-1.844l1.715-0.205 c0.263-0.031,0.477-0.271,0.477-0.537v-2.498C19.209,16.957,18.994,16.718,18.73,16.686z M9.605,23.271 c-2.651,0-4.801-2.148-4.801-4.801c0-2.652,2.15-4.802,4.801-4.802c2.652,0,4.801,2.149,4.801,4.802 C14.407,21.123,12.257,23.271,9.605,23.271z"></path> <path d="M30.641,8.804L29.35,8.651c-0.132-0.492-0.324-0.959-0.574-1.39l0.803-1.02c0.123-0.155,0.107-0.399-0.033-0.54 l-1.33-1.329c-0.14-0.142-0.383-0.156-0.54-0.033l-1.021,0.803c-0.43-0.249-0.896-0.441-1.385-0.571l-0.156-1.29 c-0.022-0.198-0.205-0.359-0.402-0.359H22.83c-0.199,0-0.381,0.161-0.404,0.359l-0.154,1.29c-0.492,0.13-0.957,0.323-1.388,0.572 l-1.021-0.802c-0.156-0.122-0.399-0.107-0.539,0.031l-1.331,1.332c-0.142,0.141-0.155,0.383-0.032,0.539l0.803,1.021 c-0.25,0.43-0.441,0.896-0.574,1.388L16.9,8.806c-0.198,0.023-0.359,0.206-0.359,0.405v1.881c0,0.197,0.162,0.381,0.359,0.402 l1.289,0.157c0.133,0.49,0.326,0.955,0.574,1.386l-0.803,1.02c-0.122,0.156-0.107,0.4,0.033,0.54l1.328,1.329 c0.141,0.143,0.383,0.156,0.539,0.033l1.021-0.804c0.43,0.249,0.896,0.442,1.387,0.572l0.155,1.292 c0.022,0.195,0.206,0.356,0.404,0.356h1.881c0.198,0,0.38-0.161,0.403-0.356l0.154-1.292c0.492-0.13,0.957-0.323,1.387-0.572 l1.021,0.802c0.157,0.123,0.399,0.109,0.54-0.031l1.33-1.332c0.141-0.139,0.155-0.382,0.032-0.538l-0.802-1.021 c0.25-0.429,0.44-0.895,0.572-1.386l1.291-0.154c0.198-0.025,0.359-0.205,0.359-0.405V9.21 C30.999,9.009,30.837,8.829,30.641,8.804z M23.771,13.764c-1.998,0-3.615-1.618-3.615-3.614c0-1.997,1.619-3.614,3.615-3.614 c1.994,0,3.613,1.617,3.613,3.614C27.384,12.145,25.766,13.764,23.771,13.764z"></path> </g> </g> </g></svg>
    <span class="tooltip">Programar Ordenes</span>
  </a>
</li>
          
<li class="nav-item">
  <b></b>
  <b></b>
  <a href="#" onclick="programordg()" style="font-size: 35px;">
  <svg width="32px" height="32px" class="svg-iconus"  viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools --> <title>ic_fluent_extension_24_filled</title> <desc>Created with Sketch.</desc> <g id="游댌-Product-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="ic_fluent_extension_24_filled" fill="#212121" fill-rule="nonzero"> <path d="M13,2.00000002 C14.3639761,2.00000002 15.4696971,3.1057211 15.4696971,4.46969718 L15.469,5.00000002 L19,5.00000002 C19.5522847,5.00000002 20,5.44771527 20,6.00000002 L19.999,9.49900002 L18.4696972,9.50000002 C17.1602801,9.50000002 16.0888709,10.5190325 16.0052532,11.8073139 L16,11.9696972 L16,12.0303028 C16,13.3397199 17.0190325,14.4111291 18.3073139,14.4947468 L18.4696972,14.5 L19.999,14.499 L20,18.0029302 C20,18.5552149 19.5522847,19.0029302 19,19.0029302 L15.469,19.002 L15.4696971,19.5303028 C15.4696971,20.8942789 14.3639761,22 13,22 C11.6360239,22 10.5303028,20.8942789 10.5303028,19.5303028 L10.53,19.002 L6.99999998,19.0029302 C6.44771523,19.0029302 5.99999998,18.5552149 5.99999998,18.0029302 L5.99899998,14.471 L5.46969714,14.4711623 C4.10572107,14.4711623 2.99999998,13.3654412 2.99999998,12.0014651 C2.99999998,10.637489 4.10572107,9.53176794 5.46969714,9.53176794 L5.99899998,9.53100002 L5.99999998,6.00000002 C5.99999998,5.44771527 6.44771523,5.00000002 6.99999998,5.00000002 L10.53,5.00000002 L10.5303028,4.46969718 C10.5303028,3.1057211 11.6360239,2.00000002 13,2.00000002 Z" id="游꿛-Color"> </path> </g> </g> </g></svg>
    <span class="tooltip">Gestor de Ordenes Programadas</span>
  </a>
</li>
        </ul>
      </nav>

      <section class="content">
<div class="left-content" id="left-content">
  <div style="display:none;" class="ventas">
<h1>Ventas</h1><button onclick="search()" type="button" class="rech"><svg fill="#000000" height="20px" width="20px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 489.711 489.711" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M112.156,97.111c72.3-65.4,180.5-66.4,253.8-6.7l-58.1,2.2c-7.5,0.3-13.3,6.5-13,14c0.3,7.3,6.3,13,13.5,13 c0.2,0,0.3,0,0.5,0l89.2-3.3c7.3-0.3,13-6.2,13-13.5v-1c0-0.2,0-0.3,0-0.5v-0.1l0,0l-3.3-88.2c-0.3-7.5-6.6-13.3-14-13 c-7.5,0.3-13.3,6.5-13,14l2.1,55.3c-36.3-29.7-81-46.9-128.8-49.3c-59.2-3-116.1,17.3-160,57.1c-60.4,54.7-86,137.9-66.8,217.1 c1.5,6.2,7,10.3,13.1,10.3c1.1,0,2.1-0.1,3.2-0.4c7.2-1.8,11.7-9.1,9.9-16.3C36.656,218.211,59.056,145.111,112.156,97.111z"></path> <path d="M462.456,195.511c-1.8-7.2-9.1-11.7-16.3-9.9c-7.2,1.8-11.7,9.1-9.9,16.3c16.9,69.6-5.6,142.7-58.7,190.7 c-37.3,33.7-84.1,50.3-130.7,50.3c-44.5,0-88.9-15.1-124.7-44.9l58.8-5.3c7.4-0.7,12.9-7.2,12.2-14.7s-7.2-12.9-14.7-12.2l-88.9,8 c-7.4,0.7-12.9,7.2-12.2,14.7l8,88.9c0.6,7,6.5,12.3,13.4,12.3c0.4,0,0.8,0,1.2-0.1c7.4-0.7,12.9-7.2,12.2-14.7l-4.8-54.1 c36.3,29.4,80.8,46.5,128.3,48.9c3.8,0.2,7.6,0.3,11.3,0.3c55.1,0,107.5-20.2,148.7-57.4 C456.056,357.911,481.656,274.811,462.456,195.511z"></path> </g> </g> </g></svg></button></div>
  
  
  <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Despachos</title>
    <style>
        
        .container {
            max-width: 100%;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        #resultados label {
            display: block;
            margin-bottom: 5px;
            width: 152px;
            margin-top: 12px;
        }
        #resultados input {
            width: 148px;
            padding: 8px;
            box-sizing: border-box;
        }
        
        #resultados select {
            width: 148px;
            padding: 8px;
            box-sizing: border-box;
        }
      
        #resultados button {
            padding: 10px 15px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            margin left: 5px;
        }
        #resultados {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            margin-left: -20px;
        }
        #resultados td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            font-size: 13px;
        }
       #resultados th {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            font-size: 13px;
        }
        #resultados th {
            background-color: #f4f4f4;
        }
        .total-row {
            background-color: #f4f4f4;
            font-weight: bold;
        }
        .total-general-row {
            background-color: #d0e7ff; /* Azul claro */
            font-weight: bold;
        }
        .zero {
            font-size: 12px !important;
            margin-top: 0px !important;
        }
    </style>
</head>
<body>
    <div class="container">
 <h1 style="margin-top: -13px;margin-bottom: 10px;">Despachos</h1>

        <div style="display:none;" class="form-group">
            <label for="vendedor">Vendedor</label>
            <input type="text" id="vendedor">
        </div>
      <style>
       .dvv {
                background-color: transparent;
    padding: 20px;
    text-align: center;
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
    position: relative;
    z-index: 2;
    top: -165px;
    right: -379px;
    width: 586px;
        }

        .hidden {
            opacity: 0;
            transform: translateY(-100%);
        }
    </style>
       <script>
const dvv = document.getElementById('dvv');

        window.addEventListener('scroll', () => {
            if (window.scrollY > 0) {
                dvv.classList.add('hidden');
            } else {
                dvv.classList.remove('hidden');
            }
        });
});

    </script>

      <div style="display: ruby;">
        <div class="form-group" style="margin-left: -23px;"> 
<label for="fecha-despacho" style="margin-bottom: 5px; width: 152px; margin-top: 12px;">Fecha de Despacho</label>
<input type="date" id="fecha-despacho" style="width: 135px;">
        </div></div>
<button style="margin-left: 5px; height: 35px;" onclick="filtrarDatos()">Buscar</button>
      
<div class="dvv" id="dvv">
<div class="clock" id="clock" style="display: none;">
	<div class="hour"></div>
	<div class="min"></div>
	<div class="sec"></div>
</div>
<div style="text-align:center;padding:1em 0; position: absolute; top:30px; right: 400px;"> <iframe src="https://www.zeitverschiebung.net/clock-widget-iframe-v2?language=es&size=medium&timezone=America%2FBogota" width="100%" height="115" Style="height:115px !important;" frameborder="0" seamless></iframe> </div></div>
      
        <table id="resultados">
            <thead>
                <tr>
                    <th style="width: 250px;">Cliente</th>
                    <th style="width: 70px;">Grado</th> 
                    <th>L칤nea</th>
                    <th>Observaciones</th>
                    <th>Producto</th>
                    <th>Empaque</th>
                    <th>Cantidad Cajas</th>
                    <th>Tallos x Ramo</th>
                    <th>Ramos x Pieza</th>
                    <th>Total Ramos</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const SHEET_ID = '1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w';
        const API_KEY = 'AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8';

        function extractNumericValue(html) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            const textContent = tempDiv.textContent || tempDiv.innerText || '';
            const numbers = textContent.match(/[\d\.,]+/g) || [];
            return numbers.reduce((sum, num) => sum + parseFloat(num.replace(',', '.')), 0);
        }

        function filtrarDatos() {
            const vendedor = document.getElementById('vendedor').value.toLowerCase();
            const fechaDespacho = document.getElementById('fecha-despacho').value;
            const sheetRange = 'Sellers!A:AL';

            gapi.client.init({
                apiKey: API_KEY
            }).then(() => {
                return gapi.client.request({
                    path: `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${sheetRange}`
                });
            }).then((response) => {
                const rows = response.result.values;
                const filteredRows = rows.filter(row => {
                    const vendedorMatch = vendedor ? row[34] && row[34].toLowerCase().includes(vendedor) : true;
                    const fechaMatch = fechaDespacho ? row[7] === fechaDespacho : true;
                    return vendedorMatch && fechaMatch;
                });

                const resultadosTable = document.getElementById('resultados').getElementsByTagName('tbody')[0];
                resultadosTable.innerHTML = '';

                let currentCliente = '';
                let sumCantidadCajas = 0;
                let sumTallosRamo = 0;
                let sumRamosPieza = 0;
                let sumTotalRamos = 0;
                let totalGeneralCantidadCajas = 0;
                let totalGeneralTallosRamo = 0;
                let totalGeneralRamosPieza = 0;
                let totalGeneralTotalRamos = 0;
                let hasTotalRow = false;
                let firstTotalSkipped = false;

                filteredRows.forEach((row, index) => {
                    const cliente = row[0] === '1' ? row[5] || '' : '';
                    const cantidadCajas = parseFloat(row[10]) || 0;
                    const tallosRamoHTML = row[15] || '';
                    const ramosPiezaHTML = row[16] || '';
                    const totalRamosHTML = row[17] || '';

                    const tallosRamo = extractNumericValue(tallosRamoHTML);
                    const ramosPieza = extractNumericValue(ramosPiezaHTML);
                    const totalRamos = extractNumericValue(totalRamosHTML);

                    if (cliente !== currentCliente && currentCliente !== '') {
                        if (!hasTotalRow && firstTotalSkipped) {
                            const totalRow = resultadosTable.insertRow();
                            totalRow.className = 'total-row';
                            totalRow.insertCell().innerHTML = 'TOTAL';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = sumCantidadCajas.toFixed(2);
                            totalRow.insertCell().innerHTML = sumTallosRamo.toFixed(2);
                            totalRow.insertCell().innerHTML = sumRamosPieza.toFixed(2);
                            totalRow.insertCell().innerHTML = sumTotalRamos.toFixed(2);

                            totalGeneralCantidadCajas += sumCantidadCajas;
                            totalGeneralTallosRamo += sumTallosRamo;
                            totalGeneralRamosPieza += sumRamosPieza;
                            totalGeneralTotalRamos += sumTotalRamos;

                            sumCantidadCajas = 0;
                            sumTallosRamo = 0;
                            sumRamosPieza = 0;
                            sumTotalRamos = 0;
                            hasTotalRow = false;
                        } else if (!hasTotalRow) {
                            firstTotalSkipped = true;
                        }
                    }

                    const newRow = resultadosTable.insertRow();
                    newRow.insertCell().innerHTML = cliente;
                    newRow.insertCell().innerHTML = row[20] || '';
                    newRow.insertCell().innerHTML = row[0] || '';
                    newRow.insertCell().innerHTML = row[37] || '';
                    newRow.insertCell().innerHTML = row[9] || '';
                    newRow.insertCell().innerHTML = row[11] || '';
                    newRow.insertCell().innerHTML = cantidadCajas.toFixed(2);
                    newRow.insertCell().innerHTML = tallosRamoHTML;
                    newRow.insertCell().innerHTML = ramosPiezaHTML;
                    newRow.insertCell().innerHTML = totalRamosHTML;

                    sumCantidadCajas += cantidadCajas;
                    sumTallosRamo += tallosRamo;
                    sumRamosPieza += ramosPieza;
                    sumTotalRamos += totalRamos;

                    if (index === filteredRows.length - 1 || (filteredRows[index + 1][5] !== cliente && filteredRows[index + 1][0] === '1')) {
                        if (firstTotalSkipped) {
                            const totalRow = resultadosTable.insertRow();
                            totalRow.className = 'total-row';
                            totalRow.insertCell().innerHTML = 'TOTAL';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = '';
                            totalRow.insertCell().innerHTML = sumCantidadCajas.toFixed(2);
                            totalRow.insertCell().innerHTML = sumTallosRamo.toFixed(2);
                            totalRow.insertCell().innerHTML = sumRamosPieza.toFixed(2);
                            totalRow.insertCell().innerHTML = sumTotalRamos.toFixed(2);

                            totalGeneralCantidadCajas += sumCantidadCajas;
                            totalGeneralTallosRamo += sumTallosRamo;
                            totalGeneralRamosPieza += sumRamosPieza;
                            totalGeneralTotalRamos += sumTotalRamos;

                            sumCantidadCajas = 0;
                            sumTallosRamo = 0;
                            sumRamosPieza = 0;
                            sumTotalRamos = 0;
                            hasTotalRow = true;
                        } else {
                            firstTotalSkipped = true;
                        }
                    }

                    currentCliente = cliente;
                });

                if (filteredRows.length > 0) {
                    const totalGeneralRow = resultadosTable.insertRow();
                    totalGeneralRow.className = 'total-general-row';
                    totalGeneralRow.insertCell().innerHTML = 'TOTAL GENERAL';
                    totalGeneralRow.insertCell().innerHTML = '';
                    totalGeneralRow.insertCell().innerHTML = '';
                    totalGeneralRow.insertCell().innerHTML = '';
                    totalGeneralRow.insertCell().innerHTML = '';
                    totalGeneralRow.insertCell().innerHTML = '';
                    totalGeneralRow.insertCell().innerHTML = totalGeneralCantidadCajas.toFixed(2);
                    totalGeneralRow.insertCell().innerHTML = totalGeneralTallosRamo.toFixed(2);
                    totalGeneralRow.insertCell().innerHTML = totalGeneralRamosPieza.toFixed(2);
                    totalGeneralRow.insertCell().innerHTML = totalGeneralTotalRamos.toFixed(2);
                }
            }).catch((error) => {
                console.error('Error al cargar datos:', error);
            });
        }

        function handleClientLoad() {
            gapi.load('client', filtrarDatos);
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const formattedDate = `${year}-${month}-${day}`;
            document.getElementById('fecha-despacho').value = formattedDate;
        });

        handleClientLoad();
      filtrarDatos();
    </script>
</body>
</html>

  
  
  
  
          <div style="display:none" class="activities">
<input type="hidden" id="searchInput" placeholder="Buscar por t칤tulo">
<input type="hidden" id="searchInputColumnA" placeholder="Filtrar por columna A..." value="1">
<div class="containers2" id="cardsContainer"></div>
<script>
        document.addEventListener("DOMContentLoaded", function() {
            // Selecciona el bot칩n por su ID
            var button = document.getElementById('fetchClientesBtn');
            // Activa el bot칩n
            button.disabled = false;

            // Autoclickea el bot칩n despu칠s de un segundo
            setTimeout(function() {
                button.click();
            }, 500);
        });

    </script>
<script>
  
  
  
    async function fetchData() {
        const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/Sellers!A:AL?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8');
        const data = await response.json();
        return data.values.slice(1); // Remove header row
    }

    function createCardadd(fecha, Orden, Cliente, Producto, Agencia, Pais, FechaD, rowId) {
        const cardadd = document.createElement('div');
        cardadd.classList.add('cardadd');
        cardadd.dataset.rowId = rowId;
        cardadd.innerHTML = `
            <table style="width:90%;text-align: center; font-size: 0.8em;">
                <tr>
                 <td style="width:10%; min-width: 78px;">${fecha}</td>
                 <td style="width:5%; ">${Orden}</td>
                    <td style="width:20%">${Cliente}</td>
                    <td style="width:15%">${Agencia}</td>
                    <td style="width:15%">${Pais}</td>
                    <td style="width:10%">${FechaD}</td>
                </tr>
            </table>
            <button class="deleteButton" onclick="deleteCard(${rowId})">Eliminar</button>
            
        `;
        return cardadd;
    }

    async function deleteRow(rowId) {
        const response = await fetch('https://script.google.com/macros/s/AKfycbyqtencHCB5Ex0Av8yFh188BpWlCg-HwxUbia0iWWLfArSzIecwWQqqFyZU1W1n2r5T9A/exec', {
            method: 'POST',
            body: JSON.stringify({ row: rowId })
        });
        if (response.ok) {
            console.log('Row deleted successfully');
        } else {
            console.error('Error deleting row');
        }
    }




    async function deleteCard(rowId) {
        const shouldDelete = await confirmDelete();
        if (shouldDelete) {
            await deleteRow(rowId);
            const cardToDelete = document.querySelector(`.cardadd[data-row-id="${rowId}"]`);
            if (cardToDelete) {
                cardToDelete.style.display = 'none';
            }
        }
    }

    async function confirmDelete() {
        const result = await Swal.fire({
            title: '쮼st치s seguro?',
            text: '쮻eseas eliminar la publicaci칩n?',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'S칤',
            cancelButtonText: 'No'
        });
        return result.isConfirmed;
    }

    async function editCard(rowId) {
        const rowData = await fetchRowData(rowId);
        const formInputs = await showEditForm(rowData);
        if (formInputs) {
            // Aqu칤 puedes enviar los datos actualizados al servidor para realizar la actualizaci칩n en la hoja de c치lculo
            console.log('Datos actualizados:', formInputs);
        }
    }

    async function fetchData() {
        const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/Sellers!A:AL?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8');
        const data = await response.json();
        return data.values.slice(1); // Remove header row
    }

    function createCardadd(fecha, Orden, Cliente, Producto, Agencia, Pais, FechaD, rowId, valorColumna24) {
        const cardadd = document.createElement('div');
        cardadd.classList.add('cardadd');
        cardadd.dataset.rowId = rowId;

        // Color de fondo condicional
        if (valorColumna24 !== undefined && valorColumna24.trim() !== '') {
            cardadd.style.backgroundColor = '#00800030';
            cardadd.style.backgroundImage = 'linear-gradient(240deg, #97e7d1 0%, #ecfcc3 100%)';
        } else {
            cardadd.style.backgroundColor = '#e6a7c3b5;';
            cardadd.style.backgroundImage = 'linear-gradient(240deg, #fc8ebe 0%, #fce5c3 100%)';
        }

        cardadd.innerHTML = `
        <table style="width:99%;text-align: center; font-size: 0.8em;">
            <tr>
                <td style="width:10%; min-width: 78px;">${fecha}</td>
                <td style="width:5%; ">${Orden}</td>
                <td style="width:20%">${Cliente}</td>
                <td style="width:15%">${Agencia}</td>
                <td style="width:15%">${Pais}</td>
                <td style="width:10%">${FechaD}</td>
            </tr>
        </table>
        <button id="deleteButton" class="deleteButton" onclick="deleteCard(${rowId})" style="display:none;">Eliminar</button>
<button id="detailsButton" class="detailsButton" onclick="mostrarSweetAlert('${FechaD}', '${Cliente}'); buscarCoincidencias()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Detalles</button>
    `;
    return cardadd;
}

  
  
function buscarCoincidencias() {
        var input1 = $('#swal-input1').val();
        var input2 = $('#swal-input2').val();
        var apiKey = 'AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8';
        var sheetName = 'Sellers';
        var url = 'https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/' + sheetName + '!B:U?key=' + apiKey;

        $.ajax({
            url: url,
            type: 'GET',
            success: function(response) {
                var values = response.values;
                var resultados = [];

                values.forEach(function(row) {
                    var valorInput1 = row[6]; // Columna H
                    var valorInput2 = row[4]; // Columna F

                    if (valorInput1 === input1 && valorInput2 === input2) {
                        // Si hay coincidencia, agregamos la fila a los resultados
                        resultados.push(row.slice(0, 3).concat(row.slice(4))); // Obtenemos las columnas B a U, omitiendo la columna E
                    }
                });
                // Mostramos los resultados en una tabla
                mostrarResultados(resultados);
            },
            error: function(error) {
                console.error('Error al obtener los datos:', error);
            }
        });
    }

    function mostrarResultados(resultados) {
        var tabla = $('#tabla-resultados');
        tabla.empty();

        // Encabezados de la tabla
        var encabezados = ['Fecha de Creado', 'Tipo', 'Pais', 'Cliente', 'Agencia', 'Fecha de Despaho', 'Semana', 'Producto', 'Cantidad', 'Empaque', 'Pieces', 'Tallos x Caja', 'Tallos Total', 'Tallo x Ramo', 'Ramo x Pieza', 'Total Ramos', 'Precio', 'Total Precio', 'Grado'];
        var encabezadosHTML = '<tr>';
        encabezados.forEach(function(encabezado) {
            encabezadosHTML += '<th>' + encabezado + '</th>';
        });
        encabezadosHTML += '</tr>';
        tabla.append(encabezadosHTML);

        // Filas de resultados
        resultados.forEach(function(fila) {
            var filaHTML = '<tr>';
            fila.forEach(function(celda) {
                filaHTML += '<td>' + celda + '</td>';
            });
            filaHTML += '</tr>';
            tabla.append(filaHTML);
        });
    }

  function mostrarSweetAlert(FechaD, Cliente) {
    Swal.fire({
        title: `Orden de ${FechaD} del Cliente ${Cliente}`,
        html: `
            <input id="swal-input1" type="hidden" class="swal2-input" value="${FechaD}">
            <input id="swal-input2" type="hidden" class="swal2-input" value="${Cliente}">
<button onclick="buscarCoincidencias()" style="display:none;">Buscar</button>
            <table id="tabla-resultados" border="1">
                <!-- Aqu칤 se mostrar치n los resultados -->
            </table>
        `,
        showCancelButton: false,
        confirmButtonText: 'Cerrar',
        reverseButtons: true
    });
}

  
/////
  
 async function search() {
        const searchInput = document.getElementById('searchInput');
        const searchInputColumnA = document.getElementById('searchInputColumnA');
        const cardsContainer = document.getElementById('cardsContainer');
        const searchTerm = searchInput.value.toLowerCase();
        const searchTermColumnA = searchInputColumnA.value.toLowerCase() || '1'; // Valor por defecto
        cardsContainer.innerHTML = '';

        const data = await fetchData();

        data.forEach((row, index) => {
            const fecha = row[1]; // Column E
            const Orden = row[2]; // Column D
            const Cliente = row[5];
            const Producto = row[9];
            const Agencia = row[6];
            const Pais = row[3];
            const FechaD = row[7];
            const valorColumna24 = row[24]; // Columna X (JavaScript es de base 0)
            const valorColumnaA = row[0]; // Nueva columna "A" (JavaScript es de base 0)
            const searchKeyword = row[34]; // Column H

            // Verifica si los t칠rminos de b칰squeda coinciden con los valores de las columnas "H" y "A"
            const searchColumnAMatch = new RegExp(`^${searchTermColumnA}$`).test(valorColumnaA);
            if ((searchKeyword && searchKeyword.toLowerCase().includes(searchTerm)) && searchColumnAMatch) {
                const cardadd = createCardadd(fecha, Orden, Cliente, Producto, Agencia, Pais, FechaD, index + 2, valorColumna24);
                cardsContainer.appendChild(cardadd);
            }
        });
    }

document.getElementById('searchInput').addEventListener('input', search);
document.getElementById('searchInputColumnA').addEventListener('input', search); // Agrega listener para el nuevo input
</script>
          </div>

        </div>

        <div class="right-content" id="right-content">
          <div class="user-info">
            <div class="icon-container">
              <i class="fa fa-bell nav-icon"></i>
              <i class="fa fa-message nav-icon"></i>
            </div>
            <h3 id="welcomeMessage"></h3>
            <img id="userImage" src="" alt="User Image">
          </div>
              <form id="corporateForm" >
<div class="form-group">
<input type="hidden" id="linea" name="linea" value='=COUNTIF(INDIRECT("AS$1:AS"&ROW()); INDIRECT("AS"&ROW()))' required>
</div>
<div class="form-group">
<input type="hidden" id="con" name="con" value='=CONCAT(INDIRECT("H"&ROW());INDIRECT("F"&ROW()))' required>
</div>
<div style="display:none;" class="form-group">
<input type="hidden" id="con2" name="con2" value='=CONCAT(INDIRECT("AT"&ROW());INDIRECT("F"&ROW()))' required>
</div>
 <div style="display:none;">              
 <div class="form-group" id="diaprog" style="display:none">
  <label for="day" style="display:none;" >DIA A PROGRAMAR</label>
  <select id="day" name="day" style="display:none;">
    <option value="LUNES">LUNES</option>
    <option value="MARTES">MARTES</option>
    <option value="MI칄RCOLES">MI칄RCOLES</option>
    <option value="JUEVES">JUEVES</option>
    <option value="VIERNES">VIERNES</option>
    <option value="SABADO">SABADO</option>
    <option value="DOMINGO">DOMINGO</option>
  </select>
</div></div>               
 <div style="display:none;" class="form-group" id="status">
  <input type="text" id="status" name="status" value="ACTIVO">
</div> 
                
 <div style="display:none;" class="form-group" id="existe">
  <input type="text" id="existe" name="existe" value='=CONCATENATE(INDIRECT("AS" & ROW()); " "; INDIRECT("A" & ROW()))'>
</div> 

<div style="display:none;" class="form-group" id="chain">
  <input type="text" id="chain" name="chain" value='=CONCATENATE(INDIRECT("AS" & ROW()); " ";1)'>
</div> 
                
<div style="display:none;" class="form-group" id="del">
  <input type="text" id="del" name="del" value='=IF(ISNUMBER(MATCH(INDIRECT("AW" & ROW()); AV:AV; 0)); TRUE; FALSE)'>
</div> 
                
 <div class="form-group" id="fg" style="display:none;">
  <label for="fechapr" style="display:none;">Fecha de Generaci칩n:</label>
  <input type="date" id="fechapr" name="fechapr" style="display:none;" required>
</div>
<div class="form-group" style="display:none;">
  <label for="fechap">Fecha de Generaci칩n (Text)</label>
  <input type="text" id="fechap" name="fechap">
</div>

<div class="form-group" style="display:none;">
  <label style="display:none;" for="fechapord">Fecha de Generaci칩n (Text)</label>
  <input style="display:none;" type="text" id="fechapord" name="fechapord" value="ORDEN PROGRAMADA">
</div>
                
 <div class="form-group" id="fd" style="display:none;">
    <label style="display:none;" for="fechades">Fecha Despacho</label>
    <input style="display:none;" type="date" id="fechades" name="fechades" required>
</div>               
 
<script>
  // Obtener referencia a los campos de fecha y texto
  var inputDate = document.getElementById('fechapr');
  var inputText = document.getElementById('fechap');

  // Escuchar el evento de cambio en el campo de fecha
  inputDate.addEventListener('change', function() {
    // Obtener el valor seleccionado en el campo de fecha
    var selectedDate = inputDate.value;

    // Dividir la fecha en partes (d칤a, mes y a침o)
    var parts = selectedDate.split('-');
    var day = parts[2];
    var month = parts[1];
    var year = parts[0];

    // Formatear la fecha en el formato "dd/mm/aaaa"
    var formattedDate = day + '/' + month + '/' + year;

    // Asignar el valor formateado al campo de texto
    inputText.value = formattedDate;
  });
</script>

     <div class="form-group" style="display:none;">
  <label for="tiporden">Tipo Orden</label>
  <select id="tiporden" name="tiporden">
    <option value="P.V">MERCADO ABIERTO - P.V</option>
    <option value="M.S">MUESTRAS - M.S</option>
  </select>
</div>
      
      <div class="form-group" style="display:none;">
        <label for="paisseller">Pais</label>
        <input type="text" id="paisseller" name="paisseller" value='=VLOOKUP(INDIRECT("F"&ROW());Clientes!B:M; 12; FALSE)'>
      </div>
      
      <div class="form-group" style="display:none;">
        <label for="cod">COD</label>
        <input type="text" id="cod" name="cod" value='=VLOOKUP(INDIRECT("F"&ROW());Clientes!B:M; 2; FALSE)'>
      </div>

 <div class="form-group" style="display:none;">
        <label for="clientel">Browse</label>
<input type="text" id="clientelsearch" name="clientelsearch" placeholder="Buscar Cliente .."></input>
      </div>
                
      <div class="form-group" style="display:none;">
        <label for="clientel">Cliente</label>
        <select class="cliente1" id="clientel" name="clientel"></select>
      </div>
          
<script>
        document.getElementById('clientelsearch').addEventListener('input', function() {
            var searchValue = this.value.toLowerCase();
            var select = document.getElementById('clientel');
            var options = select.getElementsByTagName('option');

            for (var i = 0; i < options.length; i++) {
                var optionText = options[i].textContent.toLowerCase();
                if (optionText.includes(searchValue)) {
                    options[i].style.display = '';
                } else {
                    options[i].style.display = 'none';
                }
            }
        });
    </script>
          
      <div class="form-group" style="display:none;">
        <label for="agenciaseller">Agencia</label>
        <input type="text" id="agenciaseller" name="agenciaseller" value='=VLOOKUP(INDIRECT("F"&ROW());Clientes!B:M; 5; FALSE)'>
      </div>

      
<div class="form-group" style="display:none;">
    <label for="fechadesp">Fecha Despacho Formateada</label>
    <input type="text" id="fechadesp" name="fechadesp" readonly>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const inputFecha = document.getElementById('fechades');
    const inputFechaDespacho = document.getElementById('fechadesp');

    inputFecha.addEventListener('change', function() {
        const fechaSeleccionada = new Date(inputFecha.value);
        // Sumar un d칤a a la fecha seleccionada
        fechaSeleccionada.setDate(fechaSeleccionada.getDate() + 1);
        const opcionesFecha = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
        const fechaFormateada = fechaSeleccionada.toLocaleDateString('es-ES', opcionesFecha);
        inputFechaDespacho.value = fechaFormateada;
    });
});
</script>

<div class="form-group" style="display:none;">
        <label for="productlist">Producto</label>
        <select id="productlist" name="productlist"></select>
      </div>
          
<button type="button" onclick="orden()" >ORDEN NORMAL</button>
<button type="button" onclick="follaje()">FOLLAJE</button>
<button type="button" onclick="ordenp()">PROGRAMAR ORDEN</button>
          
      <div class="form-group" style="display:none;">
    <label for="selectedProduct">Producto seleccionado:</label>
    <input type="text" id="selectedProduct" name="selectedProduct" readonly>
</div>

<script>
  // Funci칩n para cargar el contenido del modal y mostrar el SweetAlert
  function mostrarModalFollaje(parametrosURL) {
    // Obtener el contenido del modal
    var content = document.getElementById('Follajemodal').innerHTML;

    // Mostrar SweetAlert con el contenido del modal y ejecutar acciones adicionales
    Swal.fire({
      html: content,
      didOpen: () => {
        // Actualizar la URL del iframe al abrir el modal
        document.getElementById('dynamicIframe').src = parametrosURL;
      }
    });
  }

  // Funci칩n para obtener los valores y construir la URL del iframe
  function obtenerValoresYMostrarModal() {
    // Obtener valores de los inputs
    var vendedor = document.getElementById('vendedorh').value;
    var fechaGeneracion = document.getElementById('fechap').value;
    var fechaDespacho = document.getElementById('fechadesp').value;
    var cliente = document.getElementById('clientel').value;

    // Construir la URL del iframe con los par치metros
    var urlBase = 'https://www.thegreengenie.com.co/SellerAPP/discriminada/index.html';
    var parametros = {
      vendedorzzz: vendedor,
      fechaprzzz: fechaGeneracion,
      fechadeszzz: fechaDespacho,
      clientelzzz: cliente
    };

    // Filtrar y codificar los valores de los par치metros
    var queryString = Object.keys(parametros)
      .filter(function(key) { return parametros[key].trim() !== ''; })
      .map(function(key) { return key + '=' + encodeURIComponent(parametros[key]); })
      .join('&');

    var urlCompleta = urlBase + '?' + queryString;

    // Mostrar el modal despu칠s de obtener los valores y antes de mostrar el SweetAlert
    mostrarModalFollaje(urlCompleta);
  }

  // Event listener para detectar cambios en el select y mostrar el SweetAlert si es FOLLAJE
  document.getElementById('productlisten').addEventListener('change', function() {
    var selectedOption = this.options[this.selectedIndex].text;
    document.getElementById('selectedProduct').value = selectedOption;

    // Verifica si el producto seleccionado es "FOLLAJE"
    if (selectedOption === "FOLLAJE") {
      // Llamar a la funci칩n para obtener los valores y mostrar el modal
      obtenerValoresYMostrarModal();

      // Simular la carga del modal dos veces con un retraso de un segundo entre cada carga
      setTimeout(obtenerValoresYMostrarModal, 100);
    }
  });
  
  function follaje() {
    obtenerValoresYMostrarModal();

      // Simular la carga del modal dos veces con un retraso de un segundo entre cada carga
      setTimeout(obtenerValoresYMostrarModal, 100);
  }

  // Llamar a la funci칩n para cargar el contenido del modal al cargar la p치gina
  window.onload = function() {
    // Simular la carga del modal al cargar la p치gina
    obtenerValoresYMostrarModal();
  };
</script>
          

<script>
  // Funci칩n para cargar el contenido del modal y mostrar el SweetAlert
  function mostrarModalOrden(parametrosURL) {
    // Obtener el contenido del modal
    var content = document.getElementById('Follajemodal').innerHTML;

    // Mostrar SweetAlert con el contenido del modal y ejecutar acciones adicionales
    Swal.fire({
      html: content,
      didOpen: () => {
        // Actualizar la URL del iframe al abrir el modal
        document.getElementById('dynamicIframe').src = parametrosURL;
      }
    });
  }

  // Funci칩n para obtener los valores y construir la URL del iframe
  function obtenerValoresYMostrarModalO() {
    // Obtener valores de los inputs
    var vendedor = document.getElementById('vendedorh').value;
    var fechaGeneracion = document.getElementById('fechap').value;
    var fechaDespacho = document.getElementById('fechadesp').value;
    var cliente = document.getElementById('clientel').value;

    // Construir la URL del iframe con los par치metros
    var urlBase = 'https://www.thegreengenie.com.co/SellerAPP/FacturaSellers/index.html';
    var parametros = {
      vendedorh: vendedor,
      fechagen: fechaGeneracion,
      fechades: fechaDespacho,
      clientelzzz: cliente,
    };

    // Filtrar y codificar los valores de los par치metros
    var queryString = Object.keys(parametros)
      .filter(function(key) { return parametros[key].trim() !== ''; })
      .map(function(key) { return key + '=' + encodeURIComponent(parametros[key]); })
      .join('&');

    var urlCompleta = urlBase + '?' + queryString;

    // Mostrar el modal despu칠s de obtener los valores y antes de mostrar el SweetAlert
    mostrarModalFollaje(urlCompleta);
  }

  // Event listener para detectar cambios en el select y mostrar el SweetAlert si es FOLLAJE
  document.getElementById('productlisten').addEventListener('change', function() {
    var selectedOption = this.options[this.selectedIndex].text;
    document.getElementById('selectedProduct').value = selectedOption;

    // Verifica si el producto seleccionado es "FOLLAJE"
    if (selectedOption === "FOLLAJE") {
      // Llamar a la funci칩n para obtener los valores y mostrar el modal
      obtenerValoresYMostrarModal();

      // Simular la carga del modal dos veces con un retraso de un segundo entre cada carga
      setTimeout(obtenerValoresYMostrarModal, 100);
    }
  });
  
  function orden() {
    obtenerValoresYMostrarModalO();

      // Simular la carga del modal dos veces con un retraso de un segundo entre cada carga
      setTimeout(obtenerValoresYMostrarModalO, 100);
  }

  // Llamar a la funci칩n para cargar el contenido del modal al cargar la p치gina
  window.onload = function() {
    // Simular la carga del modal al cargar la p치gina
    obtenerValoresYMostrarModalO();
  };
</script>        
          
<script>
  // Funci칩n para cargar el contenido del modal y mostrar el SweetAlert
  function mostrarModalOrden(parametrosURL) {
    // Obtener el contenido del modal
    var content = document.getElementById('Follajemodal').innerHTML;

    // Mostrar SweetAlert con el contenido del modal y ejecutar acciones adicionales
    Swal.fire({
      html: content,
      didOpen: () => {
        // Actualizar la URL del iframe al abrir el modal
        document.getElementById('dynamicIframe').src = parametrosURL;
      }
    });
  }

  // Funci칩n para obtener los valores y construir la URL del iframe
  function obtenerValoresYMostrarModalOP() {
    // Obtener valores de los inputs
    var vendedor = document.getElementById('vendedorh').value;
    var fechaGeneracion = document.getElementById('fechap').value;
    var fechaDespacho = document.getElementById('fechadesp').value;
    var cliente = document.getElementById('clientel').value;

    // Construir la URL del iframe con los par치metros
    var urlBase = 'https://www.thegreengenie.com.co/SellerAPP/ORPROGRAMABLE/index.html';
    var parametros = {
      vendedorh: vendedor,
      fechagen: fechaGeneracion,
      fechades: fechaDespacho,
      clientelzzz: cliente,
    };

    // Filtrar y codificar los valores de los par치metros
    var queryString = Object.keys(parametros)
      .filter(function(key) { return parametros[key].trim() !== ''; })
      .map(function(key) { return key + '=' + encodeURIComponent(parametros[key]); })
      .join('&');

    var urlCompleta = urlBase + '?' + queryString;

    // Mostrar el modal despu칠s de obtener los valores y antes de mostrar el SweetAlert
    mostrarModalFollaje(urlCompleta);
  }

  // Event listener para detectar cambios en el select y mostrar el SweetAlert si es FOLLAJE
  document.getElementById('productlisten').addEventListener('change', function() {
    var selectedOption = this.options[this.selectedIndex].text;
    document.getElementById('selectedProduct').value = selectedOption;

    // Verifica si el producto seleccionado es "FOLLAJE"
    if (selectedOption === "FOLLAJE") {
      // Llamar a la funci칩n para obtener los valores y mostrar el modal
      obtenerValoresYMostrarModal();

      // Simular la carga del modal dos veces con un retraso de un segundo entre cada carga
      setTimeout(obtenerValoresYMostrarModal, 100);
    }
  });
  
  function ordenp() {
    obtenerValoresYMostrarModalOP();

      // Simular la carga del modal dos veces con un retraso de un segundo entre cada carga
      setTimeout(obtenerValoresYMostrarModalOP, 100);
  }

  // Llamar a la funci칩n para cargar el contenido del modal al cargar la p치gina
  window.onload = function() {
    // Simular la carga del modal al cargar la p치gina
    obtenerValoresYMostrarModalOP();
  };
</script>  

      <div class="form-group" style="display:none;" >
      <label for="concatenatedValues" >Selecci칩n</label>
      <input type="text" id="concatenatedValues" readonly>
       </div>
          
      <div class="form-group" style="display:none;">
        <label for="cantidad">Cantidad</label>
        <input type="number" id="cantidad" name="cantidad" required>
      </div>

      <div class="form-group" style="display:none;">
  <label for="empaquelist">Empaque</label>
  <select id="empaquelist" name="empaquelist">
    <option value="QB">QB</option>
    <option value="HB">HB</option>
    <option value="EB">EB</option>
    <option value="FLL">FLL</option>
  </select>
</div>

      <div class="form-group" style="display:none;">
        <label for="pieces">pieces</label>
        <input type="text" id="pieces" name="pieces" value='=VLOOKUP(INDIRECT("L"&ROW());size!A2:B5; 2; FALSE)*INDIRECT("K"&ROW())'>
      </div>

      <div class="form-group" style="display:none;">
        <label for="talloscaja">Tallos X Caja</label>
        <input type="number" id="talloscaja" name="talloscaja" required>
      </div>

      <div class="form-group" style="display:none;">
        <label for="totaltallos">Total Tallos</label>
        <input type="text" id="totaltallos" name="totaltallos" value='=INDIRECT("N"&ROW())*INDIRECT("K"&ROW())'>
      </div>

      <div class="form-group" style="display:none;">
        <label for="tallosramo">Tallos X Ramo</label>
        <input type="number" id="tallosramo" name="tallosramo" required>
      </div>

      <div class="form-group" style="display:none;">
        <label for="ramospieza">Ramos X Pieza</label>
        <input type="number" id="ramospieza" name="ramospieza" required>
      </div>

      <div class="form-group" style="display:none;">
        <label for="totalramos">Total Ramos</label>
        <input type="text" id="totalramos" name="totalramos" value='=INDIRECT("N"&ROW())/INDIRECT("P"&ROW())*INDIRECT("K"&ROW())'>
      </div>

     <div class="form-group" style="display:none;">
  <label for="precio">Precio</label>
  <input type="text" id="precio" name="precio" placeholder='Precio Acordado' pattern="[0-9,]*" title="Solo se permiten n칰meros y comas" oninput="this.value = this.value.replace(/\./g, ',');" required>
</div>



      <div class="form-group" style="display:none;"> 
        <label for="tprecio">Total Precio</label>
        <input type="text" id="tprecio" name="tprecio" value='=INDIRECT("S"&ROW())*INDIRECT("O"&ROW())'>
      </div>

      <div class="form-group" style="display:none;">
  <label for="gradolist">Grado</label>
  <select id="gradolist" name="gradolist">
    <option value="30 CMS">30 CMS</option>
    <option value="35 CMS">35 CMS</option>
    <option value="40 CMS">40 CMS</option>
    <option value="45 CMS">45 CMS</option>
    <option value="50 CMS">50 CMS</option>
    <option value="55 CMS">55 CMS</option>
    <option value="60 CMS">60 CMS</option>
    <option value="65 CMS">65 CMS</option>
    <option value="70 CMS">70 CMS</option>
    <option value="75 CMS">75 CMS</option>
  </select>
</div>

      <div class="form-group" style="display:none;">
        <label for="globalh">globalh</label>
        <input type="text" id="globalh" name="globalh" value='=VLOOKUP(INDIRECT("F"&ROW());Clientes!B:M; 3; FALSE)'>
      </div>

      <div class="form-group" style="display:none;">
        <label for="pesoneto">pesoneto</label>
        <input type="text" id="pesoneto" name="pesoneto" value='=VLOOKUP(INDIRECT("L"&ROW());size!A2:D5; 3; FALSE)*INDIRECT("K"&ROW())'>
      </div>

      <div class="form-group" style="display:none;">
        <label for="pesobruto">pesobruto</label>
        <input type="text" id="pesobruto" name="pesobruto" value='=VLOOKUP(INDIRECT("L"&ROW());size!A2:D5; 4; FALSE)*INDIRECT("K"&ROW())'>
      </div>

<div class="form-group" style="display:none;">
        <label  for="vendedorh">VendedorH</label>
        <input type="text" id="vendedorh" name="vendedorh">
      </div>

<button id="fetchButton" type="button" style="display:none;">Actualizar Lista de Clientes</button>
   
                
      <div class="form-group" style="display:none;">
        <label for="observaciones">Observaciones</label>
        <input type="textarea" id="observaciones" name="observaciones">
      </div>
      
      <div class="form-group" style="display:none;">
        <label for="mark">Marking</label>
        <input type="text" id="mark" name="mark">
      </div>
      
      <div class="form-group" style="display:none;">
        <label for="po">PO#</label>
        <input type="text" id="po" name="po">
      </div>

<div style="display:none;"><button type="submit" id="sub1" class="butenv" style="width: 200px; place-self: center; display:none;">Enviar</button></div>
<div style="display:none;">
<button type="button" id="sub2" class="butenv" style="width: 200px; place-self: center; display:none">Programar Orden</button></div>
    </form>
  </div>
  <script src="https://apis.google.com/js/api.js">    
  </script>
        
<section id="addClient" style="display: none;">
  <div class="container2">
    <h2 class="titulo2">Agregar Cliente Nuevo</h2>
    <form id="corporateForm2" >
      <div class="form-group">
        <label for="codigo">C칩d.</label>
        <input type="text" id="codigo" name="codigo">
      </div>

      <div class="form-group">
        <label for="nombre">Nombre</label>
        <input type="text" id="nombre" name="nombre">
      </div>

      <div class="form-group">
        <label for="global">Global</label>
        <input type="text" id="global" name="global">
      </div>

<div class="form-group" style="display: none;">
        <label for="vendedor">Vendedor</label>
        <input type="text" id="vendedor" name="vendedor">
      </div>

      <div class="form-group">
        <label for="agencia">Agencia</label>
        <input type="text" id="agencia" name="agencia">
      </div>

      <div class="form-group">
        <label for="etiq">ETIQ</label>
        <input type="text" id="etiq" name="etiq" placeholder="K.S">
      </div>

      <div class="form-group">
        <label for="notas">NOTAS</label>
        <textarea id="notas" name="notas" style="width: 100%; height: 28px;"></textarea>
      </div>

      <div class="form-group">
        <label for="consolidado1">CONSOLIDADO</label>
        <input type="text" id="consolidado1" name="consolidado1">
      </div>

      <div class="form-group">
        <label for="segundaAgencia">2da Agencia</label>
        <input type="text" id="segundaAgencia" name="segundaAgencia">
      </div>

      <div class="form-group">
        <label for="consolidado2">CONSOLIDADO</label>
        <input type="text" id="consolidado2" name="consolidado2">
      </div>

      <div class="form-group">
        <label for="state">State</label>
        <input type="text" id="state" name="state">
      </div>

      <div class="form-group">
        <label for="pais">Pais</label>
        <input type="text" id="pais" name="pais">
      </div>

      <div class="form-group">
        <label for="address">Address</label>
        <input type="text" id="address" name="address">
      </div>

      <div class="form-group">
        <label for="phone">Phone</label>
        <input type="text" id="phone" name="phone">
      </div>

      <div class="form-group">
        <label for="billTo">Bill to</label>
        <input type="text" id="billTo" name="billTo">
      </div>

      <div class="form-group">
        <label for="tax">Tax</label>
        <input type="text" id="tax" name="tax">
      </div>

      <div class="form-group">
        <label for="zipCode">Zip code</label>
        <input type="text" id="zipCode" name="zipCode">
      </div>

      <div class="form-group">
        <label for="country">Country</label>
        <input type="text" id="country" name="country">
      </div>

      <div class="form-group">
        <label for="principalOwner">Principal Owner</label>
        <input type="text" id="principalOwner" name="principalOwner">
      </div>

      <div class="form-group">
        <label for="email">E-mail</label>
        <input type="email" id="email" name="email">
      </div>

      <div class="form-group">
        <label for="buyerContact">Buyer contact</label>
        <input type="text" id="buyerContact" name="buyerContact">
      </div>

      <div class="form-group">
        <label for="email2">E-mail2</label>
        <input type="email" id="email2" name="email2">
      </div>

      <div class="form-group">
        <label for="skype">Skype</label>
        <input type="text" id="skype" name="skype">
      </div>

      <div class="form-group">
        <label for="payableContact">Payable contact</label>
        <input type="text" id="payableContact" name="payableContact">
      </div>

      <div class="form-group">
        <label for="email3">E-mail</label>
        <input type="email" id="email3" name="email3">
      </div>

      <div class="form-group">
        <label for="skype2">Skype</label>
        <input type="text" id="skype2" name="skype2">
      </div>

      <div class="form-group">
        <label for="qualityContact">Quality contact</label>
        <input type="text" id="qualityContact" name="qualityContact">
      </div>

      <div class="form-group">
        <label for="email4">E-mail</label>
        <input type="email" id="email4" name="email4">
      </div>

      <div class="form-group">
        <label for="skype3">Skype</label>
        <input type="text" id="skype3" name="skype3">
      </div>

      <button id="addclient" class="butenv" style="width: 200px; align-self: center;" type="submit">Enviar</button>
    </form>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('corporateForm').addEventListener('submit', function(event) {
      event.preventDefault(); // Evita que el formulario se env칤e de manera convencional
      
      // Enviar el formulario de manera as칤ncrona
      var formData = new FormData(this);
      fetch('https://script.google.com/macros/s/AKfycbxOjNUr5bEsw8TJ8dNE1uUj22Myg8QDXol6wJNGxOFT3NcndkiDynfnHsVLngTeVRJDBA/exec', {
        method: 'POST',
        body: formData
      })
      .then(response => {
        if (response.ok) {
          return response.text();
        }
        throw new Error('Error al enviar el formulario');
      })
      .then(data => {
        // Mostrar el mensaje de confirmaci칩n utilizando SweetAlert2
        Swal.fire({
          icon: 'success',
          title: '춰칄xito!',
          text: data // El mensaje de confirmaci칩n devuelto desde el script de Google Apps Script
        });
        setTimeout(function() {
    search();
}, 2000); // 2000 milisegundos equivalen a 2 segundos

      })
      .catch(error => {
        // En caso de error, mostrar un mensaje de error
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: error.message
        });
      });
    });
  });
  
  
  /////
  
  </script>
  
  <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('sub2').addEventListener('click', function() {
                var form = document.getElementById('corporateForm');
                
                // Evita que el formulario se env칤e de manera convencional
                event.preventDefault();

                // Enviar el formulario de manera as칤ncrona
                var formData = new FormData(form);
                fetch('https://script.google.com/macros/s/AKfycbygq3Gzk5lHIs7dfB02-aze7W18nQuLsliV7mBmYVNdIcrCw-gFF20PYyojEfyFgY4/exec', {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('Error al enviar el formulario');
                })
                .then(data => {
                    // Mostrar el mensaje de confirmaci칩n utilizando SweetAlert2
                    Swal.fire({
                        icon: 'success',
                        title: '춰칄xito!',
                        text: data // El mensaje de confirmaci칩n devuelto desde el script de Google Apps Script
                    });
                    setTimeout(function() {
                        search();
                    }, 2000); // 2000 milisegundos equivalen a 2 segundos

                })
                .catch(error => {
                    // En caso de error, mostrar un mensaje de error
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: error.message
                    });
                });
            });
        });
    </script>
  
<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('corporateForm2').addEventListener('submit', function(event) {
      event.preventDefault(); // Evita que el formulario se env칤e de manera convencional

      // Enviar el formulario de manera as칤ncrona
      var formData = new FormData(this);
      fetch('https://script.google.com/macros/s/AKfycby-TsSPFYr7xqQaZTnA1OKn8TS4Vl15tqevTwlMXMYpE5hKRR0fjmJhuiaO4URcEkbhuA/exec', {
        method: 'POST',
        body: formData
      })
      .then(response => {
        if (response.ok) {
          return response.text();
        }
        throw new Error('Error al enviar el formulario');
      })
      .then(data => {
        // Mostrar el mensaje de confirmaci칩n utilizando SweetAlert2
        Swal.fire({
          icon: 'success',
          title: '춰칄xito!',
          text: data // El mensaje de confirmaci칩n devuelto desde el script de Google Apps Script
        });
      })
      .catch(error => {
        // En caso de error, mostrar un mensaje de error
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: error.message
        });
      });
    });
  });
</script>
</section>

<section id="adminClients" style="display: none;">
 <h1 class="toptitle">Clientes</h1>
<input type="hidden" id="searchInputx" placeholder="Buscar por t칤tulo">
<div class="containers2" id="cardsContainerx"></div>

<script>
    async function fetchDatax() {
        const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/Clientes!A:AL?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8');
        const data = await response.json();
        return data.values.slice(1); // Remove header row
    }

    function createCardaddx(CDC, Ncliente, AgenciaC, Pais, rowId ) {
        const cardaddx = document.createElement('div');
        cardaddx.classList.add('cardadd');
        cardaddx.dataset.rowId = rowId;

        cardaddx.innerHTML = `
            <table style="width:90%;text-align: center; font-size: 0.8em;">
                <tr>
                    <td style="width:5%; min-width: 16px;">${CDC}</td>
                    <td style="width:33%;">${Ncliente}</td>
                    <td style="width:33%; ">${AgenciaC}</td>
                    <td style="width:33%">${Pais}</td>
                </tr>
            </table>
            <button class="deleteButtonx" onclick="deleteCardx(${rowId})">Eliminar</button>
        `;
        return cardaddx;
    }

    async function deleteRow2(rowId) {
        const response = await fetch('https://script.google.com/macros/s/AKfycbwLEOqd5aWcnjYIFX2LlkYKWHFsInlBEuBU-dL-5qE4E3R_rJeA1vMsviZfOvqH9JliPg/exec', {
            method: 'POST',
            body: JSON.stringify({ row: rowId })
        });
        if (response.ok) {
            console.log('Row deleted successfully');
        } else {
            console.error('Error deleting row');
        }
    }

    async function searchx() {
        const searchInput = document.getElementById('searchInputx');
        const cardsContainer = document.getElementById('cardsContainerx');
        const searchTerm = searchInput.value.toLowerCase();
        cardsContainer.innerHTML = '';

        const data = await fetchDatax();

        data.forEach((row, index) => {
            const CDC = row[0];
            const Ncliente = row[1];
            const AgenciaC = row[5];
            const Pais = row[12];
            const searchKeyword = row[4]; // Column H

            if (searchKeyword && searchKeyword.toLowerCase().includes(searchTerm)) {
                const cardadd = createCardaddx(CDC, Ncliente, AgenciaC, Pais, index + 2 ); // Adding 2 because sheet rows start from 2
                cardsContainer.appendChild(cardadd);
            }
        });
    }

  async function deleteCardx(rowId) {
        const shouldDelete = await confirmDelete();
        if (shouldDelete) {
            await deleteRow2(rowId);
            const cardToDelete = document.querySelector(`.cardadd[data-row-id="${rowId}"]`);
            if (cardToDelete) {
                cardToDelete.style.display = 'none';
            }
        }
    }

    async function confirmDelete() {
        const result = await Swal.fire({
            title: '쮼st치s seguro?',
            text: '쮻eseas eliminar la publicaci칩n?',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'S칤',
            cancelButtonText: 'No'
        });
        return result.isConfirmed;
    }
  
    document.getElementById('searchInputx').addEventListener('input', searchx);
</script> 
</section>  

      
      
      
<section id="programord" style="display: none;"> 
    <h1 class="toptitle">Programar Ordenes</h1>
    
    <p>Programar Ordenes</p>
    </section>  
  
      
      
      
<section id="preciosxClients" style="display: none;">  

  <h1 class="toptitle">Precios X Cliente</h1>
      
  <script src="https://apis.google.com/js/api.js"></script>

<div class="form-group">
    <label for="cliente2">Cliente</label>
    <select class="cliente2" id="cliente2" name="cliente2">
    </select><button style="background-color: #04097d; height: 25px; padding: 5px; margin: 5px;" id="fetchClientesBtn">Recargar Clientes</button>
</div>

<div class="form-group" id="productlistexe" style="display:none;">
    <label for="productlist2">Producto</label>
    <select id="productlist2" name="productlist2">
    </select>
</div>

<div class="form-group" style="display: none;">
    <label for="vendedorh2">Vendedor</label>
<input type="text" id="vendedorh2" placeholder="Ingrese el vendedor...">
</div>
<!-- Input donde se mostrar치 el concatenado de los valores seleccionados -->
<form id="clientePriceForm" action="https://script.google.com/macros/s/AKfycbziPKl5XAThG7uC6UoBG3qLZbszzQKYmZbH27oYBxn06kzrkd9lrCc-MdbuADfsrbw/exec" method="POST">
    <div class="form-group" style="display: none;">
        <label for="concatenatedValues2">Cliente y Producto</label>
        <input type="text" id="concatenatedValues2" name="concatenatedValues2">
    </div>

    <div class="form-group">
        <label for="precio2">Precio</label>
        <input type="text" id="precio2" name="precio2" placeholder='Precio' pattern="[0-9,]*" title="Solo se permiten n칰meros y comas" oninput="this.value = this.value.replace(/\./g, ',');" required>
    </div>

    <button type="submit">Asignar / Actualizar Precio</button>
  
</form>
  

    <input type="hidden" id="searchInput12" placeholder="Buscar por cliente..." value=" ">
    
    <table id="clientesTable" style="display:none;">
        <!-- Aqu칤 se generar치 la tabla -->
    </table>

    <script src="https://apis.google.com/js/api.js"></script>
   <script>
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                // Agregar el evento de clic al bot칩n
                document.getElementById('fetchClientesBtn').addEventListener('click', fetchClientes);

                // Funci칩n para hacer clic autom치ticamente en el bot칩n
                function clickButtonAutomatically() {
                    document.getElementById('fetchClientesBtn').click();
                }

                // Llamar a la funci칩n para hacer clic autom치ticamente
                clickButtonAutomatically();
            }, 10250); // 1000 milisegundos = 1 segundo

            // Funci칩n para obtener y mostrar la lista de clientes
            function fetchClientes() {
                fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/Clientes!B:E?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8')
                    .then(response => response.json())
                    .then(data => {
                        var clientes = data.values; // Obtener todos los clientes

                        var select = document.getElementById('cliente2');
                        select.innerHTML = ''; // Limpiar la lista desplegable

                        // Si se proporciona un vendedor, filtrar la lista de clientes
                        var vendedor = document.getElementById('vendedorh2').value;
                        if (vendedor) {
                            clientes = clientes.filter(row => row[3] === vendedor).map(row => row[0]);
                        }

                        // Agregar las opciones de clientes al select
                        clientes.forEach(cliente => {
                            var option = document.createElement('option');
                            option.value = cliente;
                            option.textContent = cliente;
                            select.appendChild(option);
                        });
                    })
                    .catch(error => {
                        console.error('Error al obtener la lista de clientes:', error);
                    });
            }
        });
    </script>
    <script>
  // JavaScript
function initClient() {
    gapi.client.init({
        apiKey: 'AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8',
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
    }).then(function () {
    loadTable();
    });
}


function loadTable() {
    gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: '1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w',
        range: 'ClientesPrice!A:B',
    }).then(function(response) {
        var values = response.result.values;
        var table = document.getElementById('clientesTable');
        table.innerHTML = ''; // Limpiar tabla antes de cargar datos

        // Agregar filas a la tabla
        if (values.length > 0) {
            values.forEach(function(row, index) {
                var tr = document.createElement('tr');
                var td1 = document.createElement('td');
                var td2 = document.createElement('td');
                td1.textContent = row[0]; // Columna A
                td2.textContent = row[1]; // Columna B
                tr.appendChild(td1);
                tr.appendChild(td2);
                table.appendChild(tr);
            });
        }
    });
  }

document.getElementById('searchInput12').addEventListener('input', function() {
    sit(); // Llama a la funci칩n sit cada vez que haya un cambio en el input
});

function sit() {
   var clientesTable = document.getElementById('clientesTable');
  
    clientesTable.style.display = 'inline-table';
    var searchTerm = document.getElementById('searchInput12').value.toLowerCase();
    var rows = document.getElementById('clientesTable').getElementsByTagName('tr');
    Array.from(rows).forEach(function(row, index) {
        var cells = row.getElementsByTagName('td');
        var found = false;
        Array.from(cells).forEach(function(cell) {
            var cellText = cell.textContent.toLowerCase();
            if (cellText.includes(searchTerm)) {
                found = true;
            }
        });
        if (found || index === 0) { // Mostrar el encabezado siempre
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// Llamar a la funci칩n de inicializaci칩n cuando la API de Google se cargue
gapi.load('client', initClient);

  </script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Agregar event listener al formulario
    document.getElementById('clientePriceForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Evitar el env칤o por defecto del formulario

        // Obtener los valores de los campos de entrada
        var concatenatedValues = document.getElementById('concatenatedValues2').value;
        var precio = document.getElementById('precio2').value;

        // Llamar a la funci칩n para guardar en la hoja de c치lculo
        guardarEnHojaDeCalculo(concatenatedValues, precio);
    });

    // Funci칩n para guardar los datos en la hoja de c치lculo
    function guardarEnHojaDeCalculo(concatenatedValues, precio) {
        fetch('https://script.google.com/macros/s/AKfycbziPKl5XAThG7uC6UoBG3qLZbszzQKYmZbH27oYBxn06kzrkd9lrCc-MdbuADfsrbw/exec', {
            method: 'POST',
            body: JSON.stringify({
                concatenatedValues: concatenatedValues,
                precio: precio
            })
        })
        .then(response => {
            if (response.ok) {
                alert ('Precio Registrado Satisfactoriamente');
                initClient();
              setTimeout(function() {
    loadTable();
                sit();
}, 800);
                setTimeout(function() {
    sit();
}, 1500);
            } else {
                alert.error('Error al Registrar Datos.');
            }
        })
        .catch(error => {
            console.error('Error en la solicitud:', error);
        });
    }
});
</script>

<script>
        // Obtener elementos
        const clienteSelect = document.getElementById('cliente2');
        const searchInput = document.getElementById('searchInput12');
        
        // Agregar evento change al select
        clienteSelect.addEventListener('change', function() {
            // Actualizar valor del input
            searchInput.value = clienteSelect.value;
        });
    </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
    // Llamar a fetchClientes() al cargar la p치gina
    fetchClientes();

    // Agregar event listener al bot칩n fetchButton
    document.getElementById('fetchButton').addEventListener('click', function() {
        var vendedor = document.getElementById('vendedorh').value;
        fetchClientes(vendedor);
    });

    // Funci칩n para obtener y mostrar la lista de clientes
    function fetchClientes(vendedor) {
        fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/Clientes!B:E?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8')
            .then(response => response.json())
            .then(data => {
                var clientes = data.values.map(row => row[0]); // Obtener todos los clientes
                var select = document.getElementById('clientel');
                select.innerHTML = ''; // Limpiar la lista desplegable

                // Agregar todas las opciones de clientes al select
                clientes.forEach(cliente => {
                    var option = document.createElement('option');
                    option.value = cliente;
                    option.textContent = cliente;
                    select.appendChild(option);
                });

                // Si se proporciona un vendedor, filtrar la lista de clientes
                if (vendedor) {
                    clientes = data.values.filter(row => row[3] === vendedor).map(row => row[0]);
                    select.innerHTML = ''; // Limpiar la lista desplegable

                    // Agregar solo los clientes correspondientes al vendedor al select
                    clientes.forEach(cliente => {
                        var option = document.createElement('option');
                        option.value = cliente;
                        option.textContent = cliente;
                        select.appendChild(option);
                    });
                }
            })
            .catch(error => {
                console.error('Error al obtener la lista de clientes:', error);
            });
    }
});

  </script>


  
<script>
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
        // Llamar a fetchClientes() despu칠s de un segundo
        fetchClientes();

        // Funci칩n para obtener y mostrar la lista de clientes
        function fetchClientes() {
            fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/Clientes!B:E?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8')
                .then(response => response.json())
                .then(data => {
                    var clientes = data.values; // Obtener todos los clientes

                    var select = document.getElementById('cliente2');
                    select.innerHTML = ''; // Limpiar la lista desplegable

                    // Si se proporciona un vendedor, filtrar la lista de clientes
                    var vendedor = document.getElementById('vendedorh2').value;
                    if (vendedor) {
                        clientes = clientes.filter(row => row[3] === vendedor).map(row => row[0]);
                    }

                    // Agregar las opciones de clientes al select
                    clientes.forEach(cliente => {
                        var option = document.createElement('option');
                        option.value = cliente;
                        option.textContent = cliente;
                        select.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error al obtener la lista de clientes:', error);
                });
        }
    }, 10200); // 1000 milisegundos = 1 segundo

    // Agregar event listener al cambio en los select de cliente y producto
    document.getElementById('cliente2').addEventListener('change', updateConcatenatedValues);
    document.getElementById('productlist2').addEventListener('change', updateConcatenatedValues);

    // Funci칩n para concatenar los valores de cliente y producto
    function updateConcatenatedValues() {
        var cliente = document.getElementById('cliente2').value;
        var producto = document.getElementById('productlist2').value;
        var concatenatedValues = cliente + ' ' + producto;
        document.getElementById('concatenatedValues2').value = concatenatedValues;

        // Llamar a la funci칩n para buscar el precio
        fetchPrecio(concatenatedValues);
    }

// Funci칩n para buscar el precio correspondiente en la hoja de c치lculo "ClientesPrice"
function fetchPrecio(concatenatedValues) {
    fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/ClientesPrice!A:B?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8')
        .then(response => response.json())
        .then(data => {
            var precios = data.values; // Obtener todos los precios

            // Buscar coincidencia en la hoja de c치lculo "ClientesPrice"
            var precio = precios.find(row => row[0] === concatenatedValues);

            // Si se encontr칩 el precio, asignarlo al campo de entrada correspondiente
            if (precio && precio[1] !== undefined) {
                document.getElementById('precio2').value = precio[1];
              sit();
            } else {
                // Si no se encontr칩 el precio, asignar un valor por defecto o dejar vac칤o el campo de entrada
                document.getElementById('precio2').value = '';
            }
        })
        .catch(error => {
            console.error('Error al obtener el precio:', error);
        });
}
});
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Cargar la lista de productos al cargar la p치gina
      fetchProductos();

      // Funci칩n para obtener y mostrar la lista de productos
      function fetchProductos() {
        fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/size!A7:A29?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8')
          .then(response => response.json())
          .then(data => {
            var productos = data.values.map(row => row[0]); // Obtener todos los productos
            var select = document.getElementById('productlist');
            select.innerHTML = ''; // Limpiar el select

            // Agregar todas las opciones de productos al select
            productos.forEach(producto => {
              var option = document.createElement('option');
              option.value = producto;
              option.textContent = producto;
              select.appendChild(option);
            });
          })
          .catch(error => {
            console.error('Error al obtener la lista de productos:', error);
          });
      }
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Cargar la lista de productos al cargar la p치gina
      fetchProductos();

      // Funci칩n para obtener y mostrar la lista de productos
      function fetchProductos() {
        fetch('https://sheets.googleapis.com/v4/spreadsheets/1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w/values/size!A7:A29?key=AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8')
          .then(response => response.json())
          .then(data => {
            var productos = data.values.map(row => row[0]); // Obtener todos los productos
            var select = document.getElementById('productlist2');
            select.innerHTML = ''; // Limpiar el select

            // Agregar todas las opciones de productos al select
            productos.forEach(producto => {
              var option = document.createElement('option');
              option.value = producto;
              option.textContent = producto;
              select.appendChild(option);
            });
          })
          .catch(error => {
            console.error('Error al obtener la lista de productos:', error);
          });
      }
    });
</script>
  
</section>      
      
<section id="programordg" style="display: none;">
  <h2 class="toptitle">Gestor de Ordenes Programadas</h2>
  
  <body>
  <div style="display: none;">
    <label for="search-input">Buscar por Columna AI:</label>
    <input type="text" id="search-input" oninput="filterRowsxd()">
  </div>
  <div id="sheet-container"></div>
</body>
  <script>
// ID de la hoja de c치lculo y API Key
const SHEET_IDxd = '1BMbB6UQLeGXIKAYJZoE67oiSXbqx-7qsDHaozbYPa1w';
const API_KEYxd = 'AIzaSyC7trVxLML3qsNu1jYg7Qmmgc-RuWsMZg8';

// Columnas que queremos mostrar en la tabla principal
const COLUMNS_TO_DISPLAY_MAINxd = [5, 3, 6, 45, 46, 34];
const COLUMNS_TO_DISPLAY_MODALxd = [2, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
const SEARCH_COLUMN_INDEXxd = 34; // 칈ndice de la columna "AI"

const SHEET_URLxd = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_IDxd}/values/PROGRAMORD?key=${API_KEYxd}`;
const SCRIPT_URLxd = 'https://script.google.com/macros/s/AKfycbz69lvRp1e-jm9RP6pYxgRyBb66UWR_2O6CkPhONizH4gT5_XaCStRAgSh8F_1tUHPNJg/exec';

let sheetDataxd = []; // Variable para almacenar los datos de la hoja

// Funci칩n para cargar y mostrar los datos de la hoja de c치lculo
async function loadSheetxd() {
    try {
        const response = await fetch(SHEET_URLxd);
        const data = await response.json();
        sheetDataxd = data.values;

        if (sheetDataxd.length > 0) {
            displaySheetDataxd(sheetDataxd);
        } else {
            console.error('No se encontraron datos en la Base.');
        }
    } catch (error) {
        console.error('Error al cargar Base:', error);
    }
  filterRowsxd();
}

// Funci칩n para mostrar los datos de la hoja de c치lculo en la tabla principal
function displaySheetDataxd(data) {
    const sheetContainer = document.getElementById('sheet-container');
    sheetContainer.innerHTML = ''; // Limpiar contenido anterior

    const table = document.createElement('table');

    // Agregar encabezados de tabla
    const headerRow = document.createElement('tr');
    COLUMNS_TO_DISPLAY_MAINxd.forEach(index => {
        const headerCell = document.createElement('th');
        headerCell.textContent = data[0][index];
        headerRow.appendChild(headerCell);
    });

    const detailsHeaderCell = document.createElement('th');
    detailsHeaderCell.textContent = 'Acciones';
    headerRow.appendChild(detailsHeaderCell);

    table.appendChild(headerRow);

    // Agregar filas de datos
    data.slice(1).forEach((rowData, rowIndex) => {
        if (rowData[0] === '1') { // Verificar si la columna A tiene el valor "1"
            const row = document.createElement('tr');
            row.id = `row-${rowIndex}`; // Agregar un ID 칰nico a cada fila
            COLUMNS_TO_DISPLAY_MAINxd.forEach(index => {
                const cell = document.createElement('td');
                cell.textContent = rowData[index];
                row.appendChild(cell);
            });

            // Agregar la celda del bot칩n de detalles
            const actionsCell = document.createElement('td');
            const detailsButton = document.createElement('button');
            detailsButton.textContent = 'Detalle';
            detailsButton.onclick = () => showDetailsxd(rowData[4], rowData[44], rowData[5], rowData[45], rowData[48], rowData[46]);
            actionsCell.appendChild(detailsButton);
                     
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Eliminar';
            deleteButton.className = 'deleteButton';
            deleteButton.onclick = () => confirmDeletexd(rowIndex + 2); // Pasar el 칤ndice de la fila
            actionsCell.appendChild(deleteButton);

            row.appendChild(actionsCell);
            table.appendChild(row);
        } else {
            const row = document.createElement('tr');
            row.id = `row-${rowIndex}`; // Agregar un ID 칰nico a cada fila
            row.style.display = 'none'; // Ocultar las filas que no coincidan con el filtro
            COLUMNS_TO_DISPLAY_MAINxd.forEach(() => {
                const cell = document.createElement('td');
                cell.textContent = ''; // Dejar las celdas vac칤as para mantener el formato
                row.appendChild(cell);
            });
            table.appendChild(row);
        }
    });

    sheetContainer.appendChild(table);
}

// Funci칩n para confirmar y eliminar la fila
function confirmDeletexd(rowId) {
    Swal.fire({
        title: '쮼st치s seguro?',
        text: "Esta acci칩n no se puede deshacer.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'S칤, eliminar',
        cancelButtonText: 'No, cancelar'
    }).then((result) => {
        if (result.isConfirmed) {
            deleteRowxd(rowId);
        }
    });
}

// Funci칩n para cambiar el estado de la columna "AU"
async function toggleStatusxd(rowIndex, currentStatus) {
    console.log('Datos enviados:', { rowIndex, currentStatus });

    const newStatus = currentStatus === 'ACTIVO' ? 'INACTIVO' : 'ACTIVO';
    const response = await fetch(SCRIPT_URLxd, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ rowIndex, newStatus })
    });

    if (response.ok) {
        console.log('Estado cambiado correctamente');
        loadSheetxd();
    } else {
        console.error('Error al cambiar el estado');
    }
}

// Funci칩n para filtrar las filas basadas en el valor de la columna "AI"
function filterRowsxd() {
    const searchTerm = document.getElementById('search-input').value.toLowerCase();
    const rows = document.querySelectorAll('tr[id^="row-"]'); // Seleccionar todas las filas con ID que comienza con "row-"

    rows.forEach(row => {
        const aiColumnValue = row.querySelector('td:nth-child(6)').textContent.toLowerCase(); // Obtener el valor de la columna AI (quinta columna)
        if (aiColumnValue.includes(searchTerm)) {
            row.style.display = ''; // Mostrar la fila si el t칠rmino de b칰squeda est치 contenido en la columna AI
        } else {
            row.style.display = 'none'; // Ocultar la fila si el t칠rmino de b칰squeda no coincide
        }
    });
}

// Funci칩n para mostrar los detalles en un SweetAlert con filtro
function showDetailsxd(col5Value, col45Value, cliente, dia, chainn, statusx) {
    // HTML para el formulario dentro del SweetAlert
    const formHtml = `
        <form id="delete-formxd" style="display:none;">
            <label for="filter-col5">Filtrar por Columna 5:</label>
            <input type="text" id="filter-col5xd" value="${col5Value}" /><br>
            <label for="filter-col45">Filtrar por Columna 45:</label>
            <input type="text" id="filter-col45xd" value="${col45Value}" /><br>
            <button type="button" id="apply-filterxd">Aplicar Filtro</button>
            <button type="button" id="delete-rowsxd">Eliminar Filas</button>
        </form>
        <div id="filtered-tablexd"></div>
        <form id="activoinactivoxd" >
    <div style="display: none;">
        <label for="chain">Chain</label>
        <input type="text" id="chainxd" name="chain" value="${chainn}">
    </div>
    <h4 style="margin: 0px;">Estado Actual: ${statusx}</h4>
    <div class="form-group">
        <label for="activador"></label>
        <select type="text" id="activadorxd" name="activador" style="text-align: center;" required>
          <option value="ACTIVO">ACTIVAR</option>
          <option value="INACTIVO">DESACTIVAR</option>
         </select> 
    </div>

    <button class="Actstate" type="submit">Actualizar Estado</button> 
</form>
    `;

    Swal.fire({
        title: `${cliente} / ${dia}`,
        html: formHtml,
        width: '98%',
        didOpen: () => {
          document.getElementById('activoinactivoxd').addEventListener('submit', function(event) {
event.preventDefault(); // Evitar el env칤o por defecto del formulario
// Obtener los valores de los campos de entrada
var chain = document.getElementById('chainxd').value;
var activador = document.getElementById('activadorxd').value;
// Llamar a la funci칩n para guardar en la hoja de c치lculo
guardarEnHojaDeCalculo(chain, activador);});
document.getElementById('apply-filterxd').addEventListener('click', applyModalFilterxd);
            document.getElementById('delete-rowsxd').addEventListener('click', () => {
                const filterCol5 = document.getElementById('filter-col5xd').value;
                const filterCol45 = document.getElementById('filter-col45xd').value;
                eliminarFilasxd(filterCol45);
                Swal.close();
            });
          applyModalFilterxd();
        },
        confirmButtonText: 'Cerrar'
    });
}

// Funci칩n para aplicar el filtro dentro del SweetAlert
function applyModalFilterxd() {
    const filterCol5 = document.getElementById('filter-col5xd').value.toLowerCase();
    const filterCol45 = document.getElementById('filter-col45xd').value.toLowerCase();

    let filteredData = sheetDataxd.filter((rowData, rowIndex) => {
        if (rowIndex === 0) return true; // Incluir siempre la fila de encabezados
        const col5Matches = rowData[4] && rowData[4].toLowerCase().includes(filterCol5);
        const col45Matches = rowData[44] && rowData[44].toLowerCase().includes(filterCol45);
        return col5Matches && col45Matches;
    });

    // Crear una tabla HTML con los datos filtrados
    let filteredTableHtml = '<table border="1" style="width: 1300px; font-size:13px; text-align: left;">';
    filteredTableHtml += '<tr>';
    COLUMNS_TO_DISPLAY_MODALxd.forEach(index => {
        filteredTableHtml += `<th>${sheetDataxd[0][index]}</th>`;
    });
    filteredTableHtml += '</tr>';

    filteredData.slice(1).forEach(rowData => {
        filteredTableHtml += '<tr>';
        COLUMNS_TO_DISPLAY_MODALxd.forEach(index => {
            filteredTableHtml += `<td>${rowData[index]}</td>`;
        });
        filteredTableHtml += '</tr>';
    });

    filteredTableHtml += '</table>';

    // Actualizar el contenido del SweetAlert con los datos filtrados
    document.getElementById('filtered-tablexd').innerHTML = filteredTableHtml;
  }

// Funci칩n para eliminar filas espec칤ficas
async function eliminarFilasxd(filterCol5, filterCol45) {
    const response = await fetch(SCRIPT_URLxd, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ filterCol5, filterCol45 })
    });

    if (response.ok) {
        console.log('Filas eliminadas correctamente');
        loadSheetxd();
    } else {
        console.error('Error al eliminar las filas');
    }
}



async function deleteRowxd(rowId) {
    const response = await fetch('https://script.google.com/macros/s/AKfycbyFQPgtek8u8WMltEwsmzES7OKZVKBerCOy2RGsrX6OrEDM_Ppbbn1uJWuNBn6eFIY/exec', {
        method: 'POST',
        body: JSON.stringify({ row: rowId })
    });
    if (response.ok) {
        console.log('Row deleted successfully');
        Toastify({
                        text: "Orden Eliminada", // El mensaje de confirmaci칩n devuelto desde el script de Google Apps Script
                        duration: 3000, // Duraci칩n del mensaje en milisegundos
                        close: true,
                        gravity: "top", // `top` or `bottom`
                        position: "right", // `left`, `center` or `right`
                        backgroundColor: "linear-gradient(to right, #00b09b, #96c93d)"
                    }).showToast();
        loadSheetxd();
    } else {
        console.error('Error deleting row');
    }
}

// Cargar la hoja de c치lculo al cargar la p치gina
window.onload = loadSheetxd;

</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</section>
  
<section id="Follajemodal" style="display: none;">
<iframe id="dynamicIframe" width="100%" height="400" frameborder="0"></iframe>
</section>

    </main>
  </body>
</section>
  
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
</body>
</html>
<!-- partial -->
  <script  src="./script.js"></script>

</body>
</html>
