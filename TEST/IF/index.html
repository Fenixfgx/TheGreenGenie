<!DOCTYPE html>
<html>
<head>
    <title>Página Principal</title>
</head>
<body>
    <div style=" background-color: #ffffffe0; width: 840px; margin: auto; text-align: -webkit-center; height: 31px;  padding-top: 12px; padding-bottom: 12px; border-bottom-right-radius: 50px; border-bottom-left-radius: 50px; z-index: 2; position: fixed; left: 20%; box-shadow: 0px 4px 9px 0px #409b0757;">
    <input class="text" type="date" id="fechaIn" placeholder="Fecha" onchange="actualizarFormatoFecha()" style="border-style: revert;">
    <select id="destinatarioInput" onchange="sincronizarSelect()">
        <!-- Las opciones se llenarán dinámicamente mediante JavaScript -->
    </select>
    <button id="buscarFuera">Buscar...<svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M11 6C13.7614 6 16 8.23858 16 11M16.6588 16.6549L21 21M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>​</button>
    </div>
    <br><br>
    <iframe style="border:none;" src="tuiframe.html" id="miIframe1" width="380" height="850"></iframe>
    <iframe style="border:none;" src="tuiframe.html" id="miIframe2" width="380" height="850"></iframe>
    <iframe style="border:none;" src="tuiframe.html" id="miIframe3" width="380" height="850"></iframe>

    <script>
        const iframes = [
            document.getElementById('miIframe1').contentWindow,
            document.getElementById('miIframe2').contentWindow,
            document.getElementById('miIframe3').contentWindow
        ];

        document.getElementById('buscarFuera').addEventListener('click', function() {
            iframes.forEach(function(iframeWindow) {
                iframeWindow.postMessage('buscarDentro', '*');
            });
        });

        function actualizarFormatoFecha() {
            const fecha = document.getElementById('fechaIn').value;
            iframes.forEach(function(iframeWindow) {
                iframeWindow.postMessage({ tipo: 'actualizarFecha', fecha: fecha }, '*');
            });
        }

        function sincronizarSelect() {
            const selectPrincipal = document.getElementById('destinatarioInput');
            const selectedOption = selectPrincipal.options[selectPrincipal.selectedIndex].value;

            iframes.forEach(function(iframeWindow) {
                iframeWindow.postMessage({ tipo: 'sincronizarSelect', selectedOption: selectedOption }, '*');
            });
        }

        window.addEventListener('message', function(event) {
            if (event.data === 'activarBotonBuscar') {
                iframes.forEach(function(iframeWindow) {
                    const botonDentroIframe = iframeWindow.document.getElementById('buscarDentro');
                    botonDentroIframe.click();
                });
            }

            if (event.data.tipo === 'actualizarSelect') {
                const selectPrincipal = document.getElementById('destinatarioInput');
                selectPrincipal.innerHTML = event.data.options;
            }
        });
    </script>
</body>
</html>
