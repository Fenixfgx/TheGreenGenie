<!DOCTYPE html>
<html>
<head>
    <title>Página Principal</title>
</head>
<body>
    <input class="text" type="date" id="fechaIn" placeholder="Fecha" onchange="actualizarFormatoFecha()">
    <br><br>
    <button id="buscarFuera">Buscar en ambos iframes</button>
    <br><br>
    <select id="destinatarioInput">
        <!-- Las opciones se llenarán dinámicamente mediante JavaScript -->
    </select>
    <br><br>
    <iframe src="tuiframe.html" id="miIframe1" width="600" height="400"></iframe>
    <iframe src="tuiframe.html" id="miIframe2" width="600" height="400"></iframe>

 <script>
        const selectPrincipal = document.getElementById('destinatarioInput');

        window.addEventListener('message', function(event) {
            if (event.data.tipo === 'actualizarSelectPrincipal') {
                selectPrincipal.innerHTML = event.data.optionsHTML;
                if (event.data.selectedOption) {
                    selectPrincipal.value = event.data.selectedOption;
                }
            }
        });

        window.onload = function() {
            const iframe = document.getElementById('miIframe').contentWindow;
            iframe.postMessage({ tipo: 'actualizarOpcionesSelectPrincipal' }, '*');
        };
    </script>

    <script>
        const iframes = [
            document.getElementById('miIframe1').contentWindow,
            document.getElementById('miIframe2').contentWindow
        ];

        document.getElementById('buscarFuera').addEventListener('click', function() {
            // Enviar un mensaje a cada iframe al hacer clic en el botón fuera de los iframes
            iframes.forEach(function(iframeWindow) {
                iframeWindow.postMessage('buscarDentro', '*');
            });
        });

        function actualizarFormatoFecha() {
            // Obtener el valor del input fecha
            const fecha = document.getElementById('fechaIn').value;

            // Enviar el valor de fecha a cada iframe
            iframes.forEach(function(iframeWindow) {
                iframeWindow.postMessage({ tipo: 'actualizarFecha', fecha: fecha }, '*');
            });
        }

        window.addEventListener('message', function(event) {
            if (event.data.tipo === 'actualizarFecha') {
                // Actualizar el valor del input date en el iframe y el select en el documento principal
                const inputFechaIframe = document.getElementById('fechaIn');
                inputFechaIframe.value = event.data.fecha;
                actualizarFormatoFecha();
            }
            if (event.data.tipo === 'actualizarSelect') {
                // Actualizar las opciones y la opción seleccionada en el select del documento principal
                const selectPrincipal = document.getElementById('destinatarioInput');
                selectPrincipal.innerHTML = event.data.optionsHTML;
                selectPrincipal.value = event.data.selectedOption;
            }
        });
    </script>
</body>
</html>